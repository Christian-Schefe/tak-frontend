@let identity = identityService.identity();
<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [dismissableMask]="true"
  header="Seeks"
  [draggable]="false"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }"
  [style]="{ width: '50vw' }"
>
  @let playerInfosMap = playerInfos();
  <p-table [value]="this.seekService.seeks()" [rowTrackBy]="trackBy">
    <ng-template #header>
      <tr>
        <th></th>
        <th>Creator</th>
        <th>Board Size</th>
        <th>Komi</th>
        <th>Reserves</th>
        <th>Time Control</th>
      </tr>
    </ng-template>
    <ng-template #body let-item>
      @let seek = asSeek(item);
      @let playerInfo = playerInfosMap[seek.creatorId];
      @let isOwnSeek = identity && identity.playerId === seek.creatorId;
      <tr>
        <td>
          <button
            pButton
            pRipple
            (click)="isOwnSeek ? onCancelSeek(seek.id) : onAcceptSeek(seek.id)"
            class="aspect-square"
            severity="secondary"
          >
            <ng-icon [name]="isOwnSeek ? 'lucideTrash' : 'lucideSwords'"></ng-icon>
          </button>
        </td>
        <td>
          @if (playerInfo.hasValue()) {
            <app-player-label [playerInfo]="playerInfo.value()"></app-player-label>
          }
        </td>
        <td>{{ seek.gameSettings.boardSize }}</td>
        <td>{{ seek.gameSettings.halfKomi / 2 }}</td>
        <td>{{ seek.gameSettings.pieces }} / {{ seek.gameSettings.capstones }}</td>
        <td>{{ seek.gameSettings.timeSettings | timeControl }}</td>
      </tr>
    </ng-template>
  </p-table>
</p-dialog>
